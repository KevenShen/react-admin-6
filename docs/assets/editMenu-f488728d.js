import{r as e,ai as g,am as S,j as r,aj as w,al as I}from"./index-882de5fd.js";import{a as K}from"./menu-d514427b.js";import{T as x}from"./index-5fafda0b.js";const O=(j,l)=>{g.useForm();const[u,a]=e.useState(!1),[i,f]=e.useState(),[h,m]=e.useState([]),[p,k]=e.useState([]),[d,s]=e.useState([]),[y,L]=e.useState(!1);e.useImperativeHandle(l,()=>({showModal:t=>{f(t),M(t),a(!0)}}));const C=async()=>{const{data:t}=await I();k(t)},M=async t=>{const{data:n}=await S(t),o=[];n.forEach(c=>{if(c.children)return o.push(...c.children.map(E=>E.id));o.push(c.id)}),s(o)};return e.useEffect(()=>{C()},[]),r(w,{forceRender:!0,title:"编辑",open:u,onOk:async()=>{await K({menu:[...d,...h],id:i}),a(!1)},confirmLoading:y,onCancel:()=>{a(!1),s([])},children:r(x,{checkable:!0,blockNode:!0,fieldNames:{title:"name",key:"id"},onCheck:(t,n)=>{m(n.halfCheckedKeys),s(t)},defaultExpandAll:!0,checkedKeys:d,treeData:p})})},T=e.forwardRef(O);export{T as default};
