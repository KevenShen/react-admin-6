{"version":3,"file":"index-69433ca7.js","sources":["../../src/api/logs.tsx","../../src/views/Logs/index.tsx"],"sourcesContent":["import request from '@/utils/request'\n\nexport function getLogList(type) {\n  return request({\n    url: `/logs/list?type=${type}`,\n    method: 'get'\n  })\n}\n\nexport function getLogdetail(detail) {\n  return request({\n    url: `/logs/detail?name=${detail}`,\n    method: 'get'\n  })\n}\n","import Panl from '@/components/TypingCard'\nimport { Radio, Select, Space } from 'antd'\nimport { useEffect, useState } from 'react'\nimport { SmileTwoTone } from '@ant-design/icons'\nimport './index.less'\nimport { getLogList } from '@/api/logs'\nimport TextArea from 'antd/es/input/TextArea'\nconst Logs = () => {\n  const [value, setvalue] = useState('access')\n  const [list, setlist] = useState([])\n  const [log, setlog] = useState('')\n  const [selectedOption, setSelectedOption] = useState(null)\n  const getList = async (item) => {\n    setSelectedOption(item)\n    setlog('')\n    const eventSource = new EventSource(`api/logs/detail?name=${item}`)\n    eventSource.onmessage = (event) => {\n      setlog(value + event.data.replace(/\\n/g, '<br />'))\n    }\n    eventSource.onerror = (event) => {\n      eventSource.close()\n      setlog('文件不存在')\n    }\n\n    return () => {\n      eventSource.close()\n    }\n  }\n  const radioChange = async (e) => {\n    setlog('')\n    setlist([])\n    setSelectedOption(null)\n    setvalue(e.target.value)\n  }\n  useEffect(() => {\n    ;(async () => {\n      // 在这里执行您想要在状态更新后执行的操作\n      const { data } = await getLogList(value)\n      const list = data.map((item) => {\n        return { value: item, label: item }\n      })\n      setlist(list)\n    })()\n  }, [value])\n\n  const text = ''\n\n  return (\n    <Panl title=\"日志信息\" source={'日志信息'}>\n      <div className=\"app-card logs\" style={{ height: '100%' }}>\n        <div className=\"logs-header\">\n          <Radio.Group value={value} onChange={radioChange}>\n            <Radio.Button value=\"access\">成功</Radio.Button>\n            <Radio.Button value=\"error\">失败</Radio.Button>\n            <Radio.Button value=\"app\">app</Radio.Button>\n          </Radio.Group>\n\n          <Select onChange={getList} style={{ width: 240 }} value={selectedOption} options={list} />\n        </div>\n        <div className=\"logs-body\">\n          <TextArea rows={4} value={log} />\n        </div>\n      </div>\n    </Panl>\n  )\n}\n\nexport default Logs\n"],"names":["getLogList","type","request","Logs","value","setvalue","useState","list","setlist","log","setlog","selectedOption","setSelectedOption","getList","item","eventSource","event","radioChange","e","useEffect","data","jsx","Panl","jsxs","Radio","Select","TextArea"],"mappings":"6JAEO,SAASA,EAAWC,EAAM,CAC/B,OAAOC,EAAQ,CACb,IAAK,mBAAmBD,CAAI,GAC5B,OAAQ,KAAA,CACT,CACH,CCAA,MAAME,EAAO,IAAM,CACjB,KAAM,CAACC,EAAOC,CAAQ,EAAIC,WAAS,QAAQ,EACrC,CAACC,EAAMC,CAAO,EAAIF,EAAA,SAAS,CAAE,CAAA,EAC7B,CAACG,EAAKC,CAAM,EAAIJ,WAAS,EAAE,EAC3B,CAACK,EAAgBC,CAAiB,EAAIN,WAAS,IAAI,EACnDO,EAAU,MAAOC,GAAS,CAC9BF,EAAkBE,CAAI,EACtBJ,EAAO,EAAE,EACT,MAAMK,EAAc,IAAI,YAAY,wBAAwBD,CAAI,EAAE,EACtD,OAAAC,EAAA,UAAaC,GAAU,CACjCN,EAAON,EAAQY,EAAM,KAAK,QAAQ,MAAO,QAAQ,CAAC,CAAA,EAExCD,EAAA,QAAWC,GAAU,CAC/BD,EAAY,MAAM,EAClBL,EAAO,OAAO,CAAA,EAGT,IAAM,CACXK,EAAY,MAAM,CAAA,CACpB,EAEIE,EAAc,MAAOC,GAAM,CAC/BR,EAAO,EAAE,EACTF,EAAQ,CAAE,CAAA,EACVI,EAAkB,IAAI,EACbP,EAAAa,EAAE,OAAO,KAAK,CAAA,EAEzBC,OAAAA,EAAAA,UAAU,IAAM,EACZ,SAAY,CAEZ,KAAM,CAAE,KAAAC,CAAS,EAAA,MAAMpB,EAAWI,CAAK,EACjCG,EAAOa,EAAK,IAAKN,IACd,CAAE,MAAOA,EAAM,MAAOA,CAAK,EACnC,EACDN,EAAQD,CAAI,CAAA,IACX,EACF,CAACH,CAAK,CAAC,EAKPiB,EAAAC,EAAA,CAAK,MAAM,OAAO,OAAQ,OACzB,SAAAC,EAAC,MAAI,CAAA,UAAU,gBAAgB,MAAO,CAAE,OAAQ,MAC9C,EAAA,SAAA,CAACA,EAAA,MAAA,CAAI,UAAU,cACb,SAAA,CAAAA,EAACC,EAAM,MAAN,CAAY,MAAApB,EAAc,SAAUa,EACnC,SAAA,CAAAI,EAACG,EAAM,OAAN,CAAa,MAAM,SAAS,SAAE,KAAA,IAC9BA,EAAM,OAAN,CAAa,MAAM,QAAQ,SAAE,KAAA,IAC7BA,EAAM,OAAN,CAAa,MAAM,MAAM,SAAG,MAAA,CAAA,EAC/B,EAECH,EAAAI,EAAA,CAAO,SAAUZ,EAAS,MAAO,CAAE,MAAO,GAAO,EAAA,MAAOF,EAAgB,QAASJ,CAAM,CAAA,CAAA,EAC1F,EACAc,EAAC,MAAI,CAAA,UAAU,YACb,SAAAA,EAACK,GAAS,KAAM,EAAG,MAAOjB,CAAA,CAAK,CACjC,CAAA,CAAA,CACF,CAAA,CACF,CAAA,CAEJ"}