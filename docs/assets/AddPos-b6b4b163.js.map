{"version":3,"file":"AddPos-b6b4b163.js","sources":["../../src/views/User/UserPos/AddPos.tsx"],"sourcesContent":["import { AutoComplete, Form, Modal } from 'antd'\nimport { forwardRef, useEffect, useImperativeHandle, useState } from 'react'\nimport { posAll } from '@/api/menu'\nimport { addUserPos } from '@/api/user'\n\nconst AddPos = (props, ref) => {\n  const [form] = Form.useForm()\n  const [value, setValue] = useState('')\n  const [options, setOptions] = useState<{ value: string }[]>([])\n  const [open, setOpen] = useState(false)\n  const [confirmLoading, setConfirmLoading] = useState(false)\n  useImperativeHandle(ref, () => ({\n    // changeVal 就是暴露给父组件的方法\n    showModal: (row) => {\n      setOpen(true)\n    }\n  }))\n\n  // 弹窗按钮提交表单\n  const handleOk = async () => {\n    try {\n      const values = await addUserPos({\n        userpos: {\n          user_id: props.id,\n          posId: form.getFieldsValue().posid\n        }\n      })\n    } catch (errorInfo) {\n      // 验证失败\n      console.log('Failed:', errorInfo)\n    }\n  }\n\n  const getpos = async () => {\n    const { data } = await posAll()\n    setOptions(\n      data.map((item) => {\n        return {\n          label: item.name,\n          value: item.name,\n          id: item.id\n        }\n      })\n    )\n  }\n\n  useEffect(() => {\n    getpos()\n  }, [])\n\n  const onSelect = (data: string, option) => {\n    setValue(option.label)\n    form.setFieldValue('posid', option.id)\n  }\n\n  // 弹窗关闭\n  const handleCancel = () => {\n    setOpen(false)\n  }\n\n  return (\n    <Modal\n      title=\"新增用户岗位\"\n      open={open}\n      onOk={handleOk}\n      destroyOnClose\n      getContainer={false}\n      confirmLoading={confirmLoading}\n      onCancel={handleCancel}>\n      <Form\n        form={form}\n        style={{ padding: '10px 60px 10px 0' }}\n        labelCol={{ span: 6 }}\n        name=\"basic\"\n        initialValues={{ remember: true }}\n        autoComplete=\"off\">\n        <Form.Item\n          label=\"选择岗位\"\n          name=\"username\"\n          rules={[{ required: true, message: 'Please input your username!' }]}>\n          <AutoComplete\n            options={options}\n            onSelect={onSelect}\n            onSearch={(text) => setValue(text)}\n            placeholder=\"input here\"\n          />\n        </Form.Item>\n        <Form.Item name=\"posid\" hidden />\n      </Form>\n    </Modal>\n  )\n}\n\nexport default forwardRef(AddPos) // 必须使用forwardRef包裹组件才能暴露方法\n"],"names":["AddPos","props","ref","form","Form","value","setValue","useState","options","setOptions","open","setOpen","confirmLoading","setConfirmLoading","useImperativeHandle","row","handleOk","values","addUserPos","errorInfo","getpos","data","posAll","item","useEffect","onSelect","option","handleCancel","jsx","Modal","jsxs","AutoComplete","text","forwardRef"],"mappings":"qLAKA,MAAMA,EAAS,CAACC,EAAOC,IAAQ,CAC7B,KAAM,CAACC,CAAI,EAAIC,EAAK,QAAQ,EACtB,CAACC,EAAOC,CAAQ,EAAIC,WAAS,EAAE,EAC/B,CAACC,EAASC,CAAU,EAAIF,EAAA,SAA8B,CAAE,CAAA,EACxD,CAACG,EAAMC,CAAO,EAAIJ,WAAS,EAAK,EAChC,CAACK,EAAgBC,CAAiB,EAAIN,WAAS,EAAK,EAC1DO,EAAA,oBAAoBZ,EAAK,KAAO,CAE9B,UAAYa,GAAQ,CAClBJ,EAAQ,EAAI,CACd,CACA,EAAA,EAGF,MAAMK,EAAW,SAAY,CACvB,GAAA,CACI,MAAAC,EAAS,MAAMC,EAAW,CAC9B,QAAS,CACP,QAASjB,EAAM,GACf,MAAOE,EAAK,eAAA,EAAiB,KAC/B,CAAA,CACD,QACMgB,EAAW,CAEV,QAAA,IAAI,UAAWA,CAAS,CAClC,CAAA,EAGIC,EAAS,SAAY,CACzB,KAAM,CAAE,KAAAC,CAAA,EAAS,MAAMC,IACvBb,EACEY,EAAK,IAAKE,IACD,CACL,MAAOA,EAAK,KACZ,MAAOA,EAAK,KACZ,GAAIA,EAAK,EAAA,EAEZ,CAAA,CACH,EAGFC,EAAAA,UAAU,IAAM,CACPJ,GACT,EAAG,CAAE,CAAA,EAEC,MAAAK,EAAW,CAACJ,EAAcK,IAAW,CACzCpB,EAASoB,EAAO,KAAK,EAChBvB,EAAA,cAAc,QAASuB,EAAO,EAAE,CAAA,EAIjCC,EAAe,IAAM,CACzBhB,EAAQ,EAAK,CAAA,EAIb,OAAAiB,EAAA,IAACC,EAAA,CACC,MAAM,SACN,KAAAnB,EACA,KAAMM,EACN,eAAc,GACd,aAAc,GACd,eAAAJ,EACA,SAAUe,EACV,SAAAG,EAAA,KAAC1B,EAAA,CACC,KAAAD,EACA,MAAO,CAAE,QAAS,kBAAmB,EACrC,SAAU,CAAE,KAAM,CAAE,EACpB,KAAK,QACL,cAAe,CAAE,SAAU,EAAK,EAChC,aAAa,MACb,SAAA,CAAAyB,EAAA,IAACxB,EAAK,KAAL,CACC,MAAM,OACN,KAAK,WACL,MAAO,CAAC,CAAE,SAAU,GAAM,QAAS,8BAA+B,EAClE,SAAAwB,EAAA,IAACG,EAAA,CACC,QAAAvB,EACA,SAAAiB,EACA,SAAWO,GAAS1B,EAAS0B,CAAI,EACjC,YAAY,YAAA,CACd,CAAA,CACF,QACC5B,EAAK,KAAL,CAAU,KAAK,QAAQ,OAAM,GAAC,CAAA,CAAA,CACjC,CAAA,CAAA,CAGN,EAEe6B,EAAAA,EAAAA,WAAWjC,CAAM"}