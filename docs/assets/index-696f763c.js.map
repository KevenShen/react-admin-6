{"version":3,"file":"index-696f763c.js","sources":["../../src/views/User/Role/index.tsx"],"sourcesContent":["import Panl from '@/components/TypingCard'\nimport { getRole, getMenu, updateRole } from '@/api/login'\nimport { Button, Col, Row, Space, Table, Tree } from 'antd'\nimport Column from 'antd/es/table/Column'\nimport { Key, useEffect, useState } from 'react'\nimport { EditOutlined, DeleteOutlined } from '@ant-design/icons'\nimport './index.less'\nimport { editmenu, getmenu } from '@/api/menu'\nconst Role = () => {\n  console.log('Role 渲染')\n\n  const [list, setList] = useState([])\n  const [treeData, settreeData] = useState([])\n  const [halfCheckedKeys, setHalfCheckedKeys] = useState([])\n  const [checkedKeys, setCheckedKeys] = useState<React.Key[]>([])\n  const [rowValue, setRowValue] = useState<React.Key[]>([])\n  const getList = async () => {\n    const { data } = await getRole()\n    setList(data)\n  }\n  const getmenyList = async () => {\n    const { data } = await getMenu()\n    settreeData(data)\n  }\n\n  const onCheck = (checkedKeysValue: any, e: { halfCheckedKeys: [] }) => {\n    setHalfCheckedKeys(e.halfCheckedKeys)\n    setCheckedKeys(checkedKeysValue)\n  }\n\n  const update = async () => {\n    const { data } = await editmenu({\n      id: rowValue[0],\n      menu: [...checkedKeys, ...halfCheckedKeys]\n    })\n  }\n  // 点击角色菜单选中\n  const inversemenu = async () => {\n    const { data } = await getmenu(rowValue[0])\n    const ketList: any[] | ((prevState: Key[]) => Key[]) = []\n    data.forEach((item) => {\n      if (item.children) return ketList.push(...item.children.map((child) => child.id))\n      ketList.push(item.id)\n    })\n    setCheckedKeys(ketList)\n  }\n  // 挂载时运行一次\n  useEffect(() => {\n    getList()\n    getmenyList()\n  }, [])\n  useEffect(() => {\n    if (rowValue.length) inversemenu()\n  }, [rowValue])\n  const cardContent =\n    '在这里，你可以对系统中的用户进行管理，例如添加一个新用户，或者修改系统中已经存在的用户。'\n  return (\n    <Panl title=\"角色管理\" source={cardContent}>\n      <div className=\"app-card role\">\n        <div className=\"role-info\">\n          <Row justify=\"space-between\" align=\"middle\">\n            <Col>角色列表</Col>\n            <Col>\n              <Button type=\"primary\" onClick={getList}>\n                查询\n              </Button>\n            </Col>\n          </Row>\n          <Table\n            bordered\n            dataSource={list}\n            rowSelection={{\n              type: 'radio',\n              selectedRowKeys: rowValue,\n              onChange: (e, row: any) => setRowValue([row[0].id])\n            }}\n            onRow={(record: any) => ({\n              onClick: () => {\n                setRowValue([record.id])\n              }\n            })}\n            rowKey={(record) => record.id}>\n            <Column title=\"角色名称\" dataIndex=\"name\" key=\"name\" />\n            <Column title=\"角色代码\" dataIndex=\"code\" key=\"code\" />\n            <Column title=\"角色等级\" dataIndex=\"level\" key=\"level\" />\n            <Column title=\"角色描述\" dataIndex=\"description\" key=\"description\" />\n\n            <Column\n              title=\"操作\"\n              key=\"action\"\n              render={(_: any, record: DataType) => (\n                <Space>\n                  <Button type=\"primary\" shape=\"circle\" icon={<EditOutlined />} />\n                  <Button type=\"primary\" danger shape=\"circle\" icon={<DeleteOutlined />} />\n                </Space>\n              )}\n            />\n          </Table>\n        </div>\n        <div className=\"role-menu\">\n          <Row justify=\"space-between\" align=\"middle\">\n            <Col>角色列表</Col>\n            <Col>\n              {' '}\n              <Button type=\"primary\" disabled={!rowValue[0]} onClick={update}>\n                保存\n              </Button>\n            </Col>\n          </Row>\n          <Tree\n            checkable\n            blockNode\n            fieldNames={{ title: 'name', key: 'id' }}\n            onCheck={onCheck}\n            selectedKeys={[1, 2, 3]}\n            checkedKeys={checkedKeys}\n            treeData={treeData}\n          />\n        </div>\n      </div>\n    </Panl>\n  )\n}\n\nexport default Role\n"],"names":["Role","list","setList","useState","treeData","settreeData","halfCheckedKeys","setHalfCheckedKeys","checkedKeys","setCheckedKeys","rowValue","setRowValue","getList","data","getRole","getmenyList","getMenu","onCheck","checkedKeysValue","e","update","editmenu","inversemenu","getmenu","ketList","item","child","useEffect","jsx","Panl","jsxs","Row","Col","Button","Table","row","record","Column","_","Space","EditOutlined","DeleteOutlined","Tree"],"mappings":"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"}