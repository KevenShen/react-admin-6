{"version":3,"file":"AddUser-c4be9030.js","sources":["../../src/hooks/useDebounce.tsx","../../src/views/User/UserPos/AddUser.tsx"],"sourcesContent":["import { useState, useEffect } from 'react'\n\nfunction useDebounce(value: any, delay: number, callback: any) {\n  const [debouncedValue, setDebouncedValue] = useState(value)\n\n  useEffect(() => {\n    const handler = setTimeout(() => {\n      setDebouncedValue(value)\n    }, delay)\n\n    return () => {\n      clearTimeout(handler)\n    }\n  }, [value, delay])\n\n  useEffect(() => {\n    if (debouncedValue) {\n      callback(debouncedValue)\n    }\n  }, [debouncedValue])\n\n  return debouncedValue\n}\n\nexport default useDebounce\n","import { getUserNameList } from '@/api/user'\nimport useDebounce from '@/hooks/useDebounce'\nimport { AutoComplete, Form, Input, Modal } from 'antd'\nimport { forwardRef, useImperativeHandle, useState } from 'react'\n\nconst AddUser = (props, ref) => {\n  const [form] = Form.useForm()\n  const [value, setValue] = useState('')\n  const [options, setOptions] = useState<{ value: string }[]>([])\n  const [open, setOpen] = useState(false)\n  const [confirmLoading, setConfirmLoading] = useState(false)\n  useImperativeHandle(ref, () => ({\n    // changeVal 就是暴露给父组件的方法\n    showModal: (row) => {\n      setOpen(true)\n    }\n  }))\n\n  // 弹窗按钮提交表单\n  const handleOk = async () => {}\n\n  useDebounce(value, 1000, async () => {\n    const { data } = await getUserNameList({\n      name: value\n    })\n    setOptions(\n      data.map((item) => {\n        return {\n          label: item.username,\n          value: item.username,\n          id: item.id\n        }\n      })\n    )\n  })\n\n  const onSelect = (data: string, option) => {\n    setValue(option.label)\n\n    form.setFieldValue('userId', option.id)\n    console.log(form.getFieldsValue(), option.id)\n  }\n\n  // 弹窗关闭\n  const handleCancel = () => {\n    setOpen(false)\n  }\n\n  return (\n    <Modal\n      title=\"新增用户岗位\"\n      open={open}\n      onOk={handleOk}\n      destroyOnClose\n      getContainer={false}\n      confirmLoading={confirmLoading}\n      onCancel={handleCancel}>\n      <Form\n        form={form}\n        style={{ padding: '10px 60px 10px 0' }}\n        labelCol={{ span: 6 }}\n        name=\"basic\"\n        initialValues={{ remember: true }}\n        autoComplete=\"off\">\n        <Form.Item\n          label=\"选择用户\"\n          name=\"username\"\n          rules={[{ required: true, message: 'Please input your username!' }]}>\n          <AutoComplete\n            options={options}\n            onSelect={onSelect}\n            onSearch={(text) => setValue(text)}\n            placeholder=\"input here\"\n          />\n        </Form.Item>\n        <Form.Item name=\"userId\" hidden />\n        <Form.Item\n          label=\"用户昵称\"\n          name=\"nickname\"\n          rules={[{ required: true, message: 'Please input your nickname!' }]}>\n          <Input autoComplete=\"off\" />\n        </Form.Item>\n      </Form>\n    </Modal>\n  )\n}\n\nexport default forwardRef(AddUser) // 必须使用forwardRef包裹组件才能暴露方法\n"],"names":["useDebounce","value","delay","callback","debouncedValue","setDebouncedValue","useState","useEffect","handler","AddUser","props","ref","form","Form","setValue","options","setOptions","open","setOpen","confirmLoading","setConfirmLoading","useImperativeHandle","row","handleOk","data","getUserNameList","item","onSelect","option","handleCancel","jsx","Modal","jsxs","AutoComplete","text","Input","forwardRef"],"mappings":"qJAEA,SAASA,EAAYC,EAAYC,EAAeC,EAAe,CAC7D,KAAM,CAACC,EAAgBC,CAAiB,EAAIC,WAASL,CAAK,EAE1DM,OAAAA,EAAAA,UAAU,IAAM,CACR,MAAAC,EAAU,WAAW,IAAM,CAC/BH,EAAkBJ,CAAK,GACtBC,CAAK,EAER,MAAO,IAAM,CACX,aAAaM,CAAO,CAAA,CACtB,EACC,CAACP,EAAOC,CAAK,CAAC,EAEjBK,EAAAA,UAAU,IAAM,CACVH,GACFD,EAASC,CAAc,CACzB,EACC,CAACA,CAAc,CAAC,EAEZA,CACT,CCjBA,MAAMK,EAAU,CAACC,EAAOC,IAAQ,CAC9B,KAAM,CAACC,CAAI,EAAIC,EAAK,QAAQ,EACtB,CAACZ,EAAOa,CAAQ,EAAIR,WAAS,EAAE,EAC/B,CAACS,EAASC,CAAU,EAAIV,EAAA,SAA8B,CAAE,CAAA,EACxD,CAACW,EAAMC,CAAO,EAAIZ,WAAS,EAAK,EAChC,CAACa,EAAgBC,CAAiB,EAAId,WAAS,EAAK,EAC1De,EAAA,oBAAoBV,EAAK,KAAO,CAE9B,UAAYW,GAAQ,CAClBJ,EAAQ,EAAI,CACd,CACA,EAAA,EAGF,MAAMK,EAAW,SAAY,CAAA,EAEjBvB,EAAAC,EAAO,IAAM,SAAY,CACnC,KAAM,CAAE,KAAAuB,GAAS,MAAMC,EAAgB,CACrC,KAAMxB,CAAA,CACP,EACDe,EACEQ,EAAK,IAAKE,IACD,CACL,MAAOA,EAAK,SACZ,MAAOA,EAAK,SACZ,GAAIA,EAAK,EAAA,EAEZ,CAAA,CACH,CACD,EAEK,MAAAC,EAAW,CAACH,EAAcI,IAAW,CACzCd,EAASc,EAAO,KAAK,EAEhBhB,EAAA,cAAc,SAAUgB,EAAO,EAAE,EACtC,QAAQ,IAAIhB,EAAK,eAAe,EAAGgB,EAAO,EAAE,CAAA,EAIxCC,EAAe,IAAM,CACzBX,EAAQ,EAAK,CAAA,EAIb,OAAAY,EAAA,IAACC,EAAA,CACC,MAAM,SACN,KAAAd,EACA,KAAMM,EACN,eAAc,GACd,aAAc,GACd,eAAAJ,EACA,SAAUU,EACV,SAAAG,EAAA,KAACnB,EAAA,CACC,KAAAD,EACA,MAAO,CAAE,QAAS,kBAAmB,EACrC,SAAU,CAAE,KAAM,CAAE,EACpB,KAAK,QACL,cAAe,CAAE,SAAU,EAAK,EAChC,aAAa,MACb,SAAA,CAAAkB,EAAA,IAACjB,EAAK,KAAL,CACC,MAAM,OACN,KAAK,WACL,MAAO,CAAC,CAAE,SAAU,GAAM,QAAS,8BAA+B,EAClE,SAAAiB,EAAA,IAACG,EAAA,CACC,QAAAlB,EACA,SAAAY,EACA,SAAWO,GAASpB,EAASoB,CAAI,EACjC,YAAY,YAAA,CACd,CAAA,CACF,QACCrB,EAAK,KAAL,CAAU,KAAK,SAAS,OAAM,GAAC,EAChCiB,EAAA,IAACjB,EAAK,KAAL,CACC,MAAM,OACN,KAAK,WACL,MAAO,CAAC,CAAE,SAAU,GAAM,QAAS,8BAA+B,EAClE,SAAAiB,EAAAA,IAACK,EAAM,CAAA,aAAa,KAAM,CAAA,CAAA,CAC5B,CAAA,CAAA,CACF,CAAA,CAAA,CAGN,EAEeC,EAAAA,EAAAA,WAAW3B,CAAO"}