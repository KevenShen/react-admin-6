import{r as n,j as e,d as s,an as h,ao as o,M as r,L as v,ap as E,al as j}from"./index-882de5fd.js";import{P as L}from"./index-0572c5fd.js";import{T as N,C as c}from"./Table-6fe0f23a.js";import{e as D,g as I}from"./menu-d514427b.js";import{T}from"./index-5fafda0b.js";import{E as M}from"./EditOutlined-f60558ff.js";import{D as O}from"./DeleteOutlined-e5a097b0.js";import"./PlusOutlined-ae187890.js";const G=()=>{console.log("Role 渲染");const[y,f]=n.useState([]),[C,k]=n.useState([]),[w,g]=n.useState([]),[l,m]=n.useState([]),[i,p]=n.useState([]),u=async()=>{const{data:t}=await E();f(t)},x=async()=>{const{data:t}=await j();k(t)},K=(t,a)=>{g(a.halfCheckedKeys),m(t)},S=async()=>{await D({id:i[0],menu:[...l,...w]})},b=async()=>{const{data:t}=await I(i[0]),a=[];t.forEach(d=>{if(d.children)return a.push(...d.children.map(R=>R.id));a.push(d.id)}),m(a)};return n.useEffect(()=>{u(),x()},[]),n.useEffect(()=>{i.length&&b()},[i]),e(L,{title:"角色管理",source:"在这里，你可以对系统中的用户进行管理，例如添加一个新用户，或者修改系统中已经存在的用户。",children:s("div",{className:"app-card role",children:[s("div",{className:"role-info",children:[s(h,{justify:"space-between",align:"middle",children:[e(o,{children:"角色列表"}),e(o,{children:e(r,{type:"primary",onClick:u,children:"查询"})})]}),s(N,{bordered:!0,dataSource:y,rowSelection:{type:"radio",selectedRowKeys:i,onChange:(t,a)=>p([a[0].id])},onRow:t=>({onClick:()=>{p([t.id])}}),rowKey:t=>t.id,children:[e(c,{title:"角色名称",dataIndex:"name"},"name"),e(c,{title:"角色代码",dataIndex:"code"},"code"),e(c,{title:"角色等级",dataIndex:"level"},"level"),e(c,{title:"角色描述",dataIndex:"description"},"description"),e(c,{title:"操作",render:(t,a)=>s(v,{children:[e(r,{type:"primary",shape:"circle",icon:e(M,{})}),e(r,{type:"primary",danger:!0,shape:"circle",icon:e(O,{})})]})},"action")]})]}),s("div",{className:"role-menu",children:[s(h,{justify:"space-between",align:"middle",children:[e(o,{children:"角色列表"}),s(o,{children:[" ",e(r,{type:"primary",disabled:!i[0],onClick:S,children:"保存"})]})]}),e(T,{checkable:!0,blockNode:!0,fieldNames:{title:"name",key:"id"},onCheck:K,selectedKeys:[1,2,3],checkedKeys:l,treeData:C})]})]})})};export{G as default};
