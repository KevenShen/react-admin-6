{"version":3,"file":"EditUser-850ad8cd.js","sources":["../../src/views/User/UserPos/EditUser.tsx"],"sourcesContent":["import { Button, Form, Modal, Popconfirm, Space, Table } from 'antd'\nimport { forwardRef, useImperativeHandle, useRef, useState } from 'react'\nimport { EditOutlined, DeleteOutlined } from '@ant-design/icons'\nimport { delUserPos } from '@/api/user'\nimport AddPos from './AddPos'\nconst { Column } = Table\n\nconst EditUser = (props, ref) => {\n  const addPos = useRef<{ showModal: () => void } | null>(null)\n  const [list, setList] = useState([])\n  const [open, setOpen] = useState(false)\n  const [user_id, setuser_id] = useState('')\n  const [confirmLoading, setConfirmLoading] = useState(false)\n  useImperativeHandle(ref, () => ({\n    // changeVal 就是暴露给父组件的方法\n    showModal: (rowlist = [], user_id) => {\n      setOpen(true)\n      setList(rowlist)\n      setuser_id(user_id)\n    }\n  }))\n\n  // 弹窗按钮提交表单\n  const delPos = async (row) => {\n    try {\n      await delUserPos({\n        userpos: { user_id: user_id, posId: row.id }\n      })\n      console.log(props)\n      props.getList()\n      setOpen(false)\n    } catch (errorInfo) {\n      // 验证失败\n      console.log('Failed:', errorInfo)\n    }\n  }\n\n  // 弹窗关闭\n  const handleCancel = () => {\n    setOpen(false)\n  }\n\n  return (\n    <Modal\n      title=\"用户岗位设置\"\n      open={open}\n      confirmLoading={confirmLoading}\n      getContainer={false}\n      destroyOnClose\n      onCancel={handleCancel}>\n      <Space wrap>\n        <Button type=\"primary\" onClick={() => addPos.current?.showModal()} className=\"btn-pink\">\n          新增\n        </Button>\n      </Space>\n      <Table bordered dataSource={list} rowKey={(record) => record.id}>\n        <Column title=\"岗位名称\" dataIndex=\"name\" key=\"name\" />\n        <Column title=\"岗位id\" dataIndex=\"id\" key=\"id\" />\n        <Column title=\"岗位描述\" dataIndex=\"description\" key=\"description\" />\n        <Column title=\"岗位状态\" dataIndex=\"status\" key=\"status\" />\n\n        <Column\n          title=\"操作\"\n          key=\"action\"\n          render={(_: any, record) => (\n            <Space>\n              <Popconfirm\n                title=\"是否确定删除该岗位?\"\n                onConfirm={() => delPos(record)}\n                okText=\"确定\"\n                cancelText=\"取消\">\n                <Button type=\"primary\" danger shape=\"circle\" icon={<DeleteOutlined />} />\n              </Popconfirm>\n            </Space>\n          )}\n        />\n      </Table>\n\n      <AddPos ref={addPos} id={user_id}></AddPos>\n    </Modal>\n  )\n}\n\nexport default forwardRef(EditUser) // 必须使用forwardRef包裹组件才能暴露方法\n"],"names":["Column","Table","EditUser","props","ref","addPos","useRef","list","setList","useState","open","setOpen","user_id","setuser_id","confirmLoading","setConfirmLoading","useImperativeHandle","rowlist","delPos","row","delUserPos","errorInfo","jsxs","Modal","jsx","Space","Button","_a","record","_","Popconfirm","DeleteOutlined","AddPos","forwardRef"],"mappings":"2WAKA,KAAM,CAAE,OAAAA,CAAW,EAAAC,EAEbC,EAAW,CAACC,EAAOC,IAAQ,CACzB,MAAAC,EAASC,SAAyC,IAAI,EACtD,CAACC,EAAMC,CAAO,EAAIC,EAAA,SAAS,CAAE,CAAA,EAC7B,CAACC,EAAMC,CAAO,EAAIF,WAAS,EAAK,EAChC,CAACG,EAASC,CAAU,EAAIJ,WAAS,EAAE,EACnC,CAACK,EAAgBC,CAAiB,EAAIN,WAAS,EAAK,EAC1DO,EAAA,oBAAoBZ,EAAK,KAAO,CAE9B,UAAW,CAACa,EAAU,GAAIL,IAAY,CACpCD,EAAQ,EAAI,EACZH,EAAQS,CAAO,EACfJ,EAAWD,CAAO,CACpB,CACA,EAAA,EAGI,MAAAM,EAAS,MAAOC,GAAQ,CACxB,GAAA,CACF,MAAMC,EAAW,CACf,QAAS,CAAE,QAAAR,EAAkB,MAAOO,EAAI,EAAG,CAAA,CAC5C,EACD,QAAQ,IAAIhB,CAAK,EACjBA,EAAM,QAAQ,EACdQ,EAAQ,EAAK,QACNU,EAAW,CAEV,QAAA,IAAI,UAAWA,CAAS,CAClC,CAAA,EASA,OAAAC,EAACC,EAAA,CACC,MAAM,SACN,KAAAb,EACA,eAAAI,EACA,aAAc,GACd,eAAc,GACd,SAXiB,IAAM,CACzBH,EAAQ,EAAK,CAAA,EAWX,SAAA,CAAAa,EAACC,GAAM,KAAI,GACT,SAACD,EAAAE,EAAA,CAAO,KAAK,UAAU,QAAS,WAAM,OAAAC,EAAAtB,EAAO,UAAP,YAAAsB,EAAgB,aAAa,UAAU,WAAW,aAExF,CAAA,EACF,EACAL,EAACrB,EAAM,CAAA,SAAQ,GAAC,WAAYM,EAAM,OAASqB,GAAWA,EAAO,GAC3D,SAAA,CAAAJ,EAACxB,EAAO,CAAA,MAAM,OAAO,UAAU,QAAW,MAAO,IAChDA,EAAO,CAAA,MAAM,OAAO,UAAU,MAAS,IAAK,IAC5CA,EAAO,CAAA,MAAM,OAAO,UAAU,eAAkB,aAAc,IAC9DA,EAAO,CAAA,MAAM,OAAO,UAAU,UAAa,QAAS,EAErDwB,EAACxB,EAAA,CACC,MAAM,KAEN,OAAQ,CAAC6B,EAAQD,MACdH,EACC,CAAA,SAAAD,EAACM,EAAA,CACC,MAAM,aACN,UAAW,IAAMZ,EAAOU,CAAM,EAC9B,OAAO,KACP,WAAW,KACX,SAAAJ,EAACE,EAAO,CAAA,KAAK,UAAU,OAAM,GAAC,MAAM,SAAS,KAAOF,EAAAO,EAAA,CAAA,CAAe,CAAI,CAAA,CAAA,CAAA,EAE3E,CAAA,EAVE,QAYN,CAAA,EACF,EAECP,EAAAQ,EAAA,CAAO,IAAK3B,EAAQ,GAAIO,EAAS,CAAA,CAAA,CAAA,CAGxC,EAEeqB,EAAAA,EAAAA,WAAW/B,CAAQ"}