{"version":3,"file":"index-eedd4346.js","sources":["../../src/api/chatgpt.tsx","../../src/views/ChatGPT/index.tsx"],"sourcesContent":["import axios from 'axios'\n\nconst config = {\n  model: 'gpt-3.5-turbo',\n  max_tokens: 1000,\n  temperature: 0\n}\n// 设置请求头\nconst headers = {\n  'Content-Type': 'application/json',\n  Authorization: 'Bearer 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'\n}\nconst service = axios.create({\n  baseURL: 'https://api.openai.com/v1/chat/completions', // api 的 base_url\n  timeout: 5000, // request timeout\n  headers\n})\n\nexport default function getGPT(messages) {\n  const data = { ...config, messages }\n  return axios.post('https://api.openai.com/v1/chat/completions', data, {\n    headers\n  })\n}\n","import Panl from '@/components/TypingCard'\nimport { Input } from 'antd'\nimport { useRecoilState, useRecoilValue } from 'recoil'\nimport './index.less'\nimport Box from './Box'\nimport { chatGPTMes } from '@/store/Module/chatGPT'\nimport { Mes } from '@/Type'\nimport { useRef, useState } from 'react'\nimport getGPT from '@/api/chatgpt'\nconst { Search } = Input\n\nfunction ChatGPT() {\n  const [gptMes, setGptMes] = useRecoilState(chatGPTMes)\n  const [value, setValue] = useState('')\n  const [lod, setLod] = useState(false)\n  const input = useRef(document.createElement('input'))\n  const onSearch = async (value: string) => {\n    input.current.blur()\n    if (!value) return\n    const arr: Array<Mes> = [\n      ...gptMes,\n      { role: 'user', content: value, time: new Date().getTime() }\n    ]\n    setValue('') // 重置\n    setGptMes(arr)\n    setLod(true)\n    const gptData = arr.map((item) => {\n      return { role: item.role, content: item.content }\n    })\n    // 发请求时不需要time否则chatgpt会报错\n    const { data }: any = await getGPT(gptData).catch((e) => {\n      setLod(false)\n      console.log(e)\n    })\n    const assistant = data.choices[0]?.message\n    setLod(false)\n    setGptMes([\n      ...arr,\n      { role: assistant.role, content: assistant.content, time: new Date().getTime() }\n    ])\n  }\n\n  return (\n    <Panl title=\"openAI 交互\" source={'ChatGPT模型'}>\n      <div className=\"app-card chat\">\n        {/* 内容盒子 */}\n        <Box></Box>\n        <Search\n          ref={input}\n          className=\"chat-search\"\n          placeholder=\"请输入你的问题\"\n          allowClear\n          value={value}\n          enterButton={lod ? '' : '发送'}\n          loading={lod}\n          onChange={(e) => setValue(e.target.value.trim())}\n          onSearch={onSearch}\n        />\n      </div>\n    </Panl>\n  )\n}\n\nexport default ChatGPT\n"],"names":["config","headers","axios","getGPT","messages","data","Search","Input","ChatGPT","gptMes","setGptMes","useRecoilState","chatGPTMes","value","setValue","useState","lod","setLod","input","useRef","jsx","Panl","jsxs","Box","arr","gptData","item","e","assistant","_a"],"mappings":"8LAEA,MAAMA,EAAS,CACb,MAAO,gBACP,WAAY,IACZ,YAAa,CACf,EAEMC,EAAU,CACd,eAAgB,mBAChB,cAAe,4DACjB,EACgBC,EAAM,OAAO,CAC3B,QAAS,6CACT,QAAS,IACT,QAAAD,CACF,CAAC,EAED,SAAwBE,EAAOC,EAAU,CACvC,MAAMC,EAAO,CAAE,GAAGL,EAAQ,SAAAI,CAAS,EAC5B,OAAAF,EAAM,KAAK,6CAA8CG,EAAM,CACpE,QAAAJ,CAAA,CACD,CACH,CCdA,KAAM,CAAE,OAAAK,CAAW,EAAAC,EAEnB,SAASC,GAAU,CACjB,KAAM,CAACC,EAAQC,CAAS,EAAIC,EAAeC,CAAU,EAC/C,CAACC,EAAOC,CAAQ,EAAIC,WAAS,EAAE,EAC/B,CAACC,EAAKC,CAAM,EAAIF,WAAS,EAAK,EAC9BG,EAAQC,EAAAA,OAAO,SAAS,cAAc,OAAO,CAAC,EA4BlD,OAAAC,EAACC,GAAK,MAAM,YAAY,OAAQ,YAC9B,SAAAC,EAAC,MAAI,CAAA,UAAU,gBAEb,SAAA,CAAAF,EAACG,EAAI,EAAA,EACLH,EAACd,EAAA,CACC,IAAKY,EACL,UAAU,cACV,YAAY,UACZ,WAAU,GACV,MAAAL,EACA,YAAaG,EAAM,GAAK,KACxB,QAASA,EACT,SAAW,GAAMF,EAAS,EAAE,OAAO,MAAM,MAAM,EAC/C,SAxCS,MAAOD,GAAkB,OAExC,GADAK,EAAM,QAAQ,OACV,CAACL,EAAO,OACZ,MAAMW,EAAkB,CACtB,GAAGf,EACH,CAAE,KAAM,OAAQ,QAASI,EAAO,KAAU,IAAA,OAAO,SAAU,CAAA,EAE7DC,EAAS,EAAE,EACXJ,EAAUc,CAAG,EACbP,EAAO,EAAI,EACX,MAAMQ,EAAUD,EAAI,IAAKE,IAChB,CAAE,KAAMA,EAAK,KAAM,QAASA,EAAK,SACzC,EAEK,CAAE,KAAArB,GAAc,MAAMF,EAAOsB,CAAO,EAAE,MAAOE,GAAM,CACvDV,EAAO,EAAK,EACZ,QAAQ,IAAIU,CAAC,CAAA,CACd,EACKC,GAAYC,EAAAxB,EAAK,QAAQ,CAAC,IAAd,YAAAwB,EAAiB,QACnCZ,EAAO,EAAK,EACFP,EAAA,CACR,GAAGc,EACH,CAAE,KAAMI,EAAU,KAAM,QAASA,EAAU,QAAS,KAAU,IAAA,KAAO,EAAA,QAAA,CAAU,CAAA,CAChF,CAAA,CAiBK,CACF,CAAA,CACF,CAAA,CACF,CAAA,CAEJ"}