import{r as e,ag as E,j as d,ah as S}from"./index-ff970420.js";import{a as w,g as I}from"./login-9644db1f.js";import{a as K}from"./menu-9a7ad817.js";import{T as x}from"./index-b7777274.js";import"./request-7bfa538c.js";import"./axios-21b846bc.js";const O=(L,l)=>{E.useForm();const[u,a]=e.useState(!1),[i,f]=e.useState(),[h,m]=e.useState([]),[p,k]=e.useState([]),[r,s]=e.useState([]),[y,b]=e.useState(!1);e.useImperativeHandle(l,()=>({showModal:t=>{f(t),g(t),a(!0)}}));const C=async()=>{const{data:t}=await I();k(t)},g=async t=>{const{data:n}=await w(t),o=[];n.forEach(c=>{if(c.children)return o.push(...c.children.map(M=>M.id));o.push(c.id)}),s(o)};return e.useEffect(()=>{C()},[]),d(S,{forceRender:!0,title:"编辑",open:u,onOk:async()=>{await K({menu:[...r,...h],id:i}),a(!1)},confirmLoading:y,onCancel:()=>{a(!1),s([])},children:d(x,{checkable:!0,blockNode:!0,fieldNames:{title:"name",key:"id"},onCheck:(t,n)=>{m(n.halfCheckedKeys),s(t)},defaultExpandAll:!0,checkedKeys:r,treeData:p})})},B=e.forwardRef(O);export{B as default};
